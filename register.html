<!DOCTYPE html>
<html>

<head>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous" />
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/ac42c3b1f7.js" crossorigin="anonymous"></script>

    <style>@import url('https://fonts.googleapis.com/css2?family=Bree+Serif&family=Caveat:wght@400;700&family=Lobster&family=Monoton&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&family=Playfair+Display+SC:ital,wght@0,400;0,700;1,700&family=Playfair+Display:ital,wght@0,400;0,700;1,700&family=Roboto:ital,wght@0,400;0,700;1,400;1,700&family=Source+Sans+Pro:ital,wght@0,400;0,700;1,700&family=Work+Sans:ital,wght@0,400;0,700;1,700&display=swap');
         
        .bg-container {
            background-size: cover;
            height: 100vh;
        }
        
        /* Fixed Background Video */
        .video-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            /* Pushes the video to the background */
            overflow: hidden;
        }
        
        .video-container video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: blur(4px);
            /* Ensures the video covers the screen */
        }
        
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            /* Change color & transparency */
        }
        
        #registration-video {
            width: 100vw;
            height: 100vh;
            object-fit: cover;
            filter: blur(40px);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        /* Scroll Container */
        .scroll-container {
            position: relative;
            z-index: 2;
            height: 100vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* Registration Section */
        .registration-section {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 120px 2rem 2rem;
        }
        
        :root {
            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --accent: #4a90e2;
            --dark-bg: #0a0a0a;
            --dark-secondary: #1a1a1a;
            --border-color: rgba(255, 255, 255, 0.1);
        }
        
        .registration-card {
            background-image: linear-gradient(#00000080, #00000080);
            border-radius: 16px;
            padding: 3rem;
            font-family: "Montserrat";
            font-size: 20px;
            border: 1px solid rgba(74, 144, 226, 0.3);
            box-shadow: 0 0 40px rgba(77, 255, 243, 0.5);
            width: 100%;
            max-width: 600px;
            margin: 2rem auto;
            animation: fadeInUp 0.6s ease;
        }
        
        /*section-title*/
        .section-title {
            font-family: "Open Sans";
            color: #ffffff;
            font-weight: 600;
            font-size: 38px;
            text-align: center;
        }
        
        .labeltext {
            color: #ffffff;
            font-size: 40px;
        }
        
        /* Form Elements */
        .registration-form {
            display: flex;
            flex-direction: column;
            gap: 1.8rem;
        }
        
        .error-messages {
            background-color: #ffe6e6;
            /* Light red background */
            color: #d8000c;
            /* Dark red text */
            border: 1px solid #d8000c;
            padding: 15px;
            width: 50%;
            margin: 20px auto;
            /* Center horizontally */
            border-radius: 8px;
            /* Rounded corners */
            text-align: center;
            /* Center text */
            font-weight: bold;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .error-messages ul {
            list-style: none;
            /* Remove bullet points */
            padding: 0;
        }
        
        .form-group label {
            display: block;
            margin-top: 25px;
            margin-bottom: 5px;
            color: #ffffff;
            font-family: 'Poppins', sans-serif;
            font-size: 0.95rem;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem 1.2rem;
            background-color: #FFFFF0;
            border-radius: 8px;
            font-size: 15px;
            color: #000000;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: var(--accent);
            box-shadow: 0 0 8px rgba(74, 144, 226, 0.3);
            outline: none;
        }
        
        .buttonwala {
            color: #FFFFF0;
            font-family: 'Inter', sans-serif;
            font-size: 15px;
        
        }
        
        .form-head {
            font-size: 20px;
            color: #ffffff;
        }
        
        /* Floating Dock */
        .floating-dock {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 3;
            padding: 0.8rem;
            background: rgba(30, 30, 30, 0.6);
            backdrop-filter: blur(12px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .registration-section {
                padding: 80px 1rem 1rem;
            }
        
            .registration-card {
                padding: 2rem;
            }
        
            .floating-dock {
                bottom: 10px;
                padding: 0.6rem;
            }
        }
        
        /* Confirmation Message */
        .confirmation-message {
            text-align: center;
            padding: 2rem;
            background: rgba(74, 144, 226, 0.1);
            border-radius: 8px;
            margin-top: 2rem;
            animation: fadeInUp 0.6s ease;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
        
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        
        /* ===== Logo Styles ===== */
        .Logo {
            width: 150px !important;
            height: auto !important;
        }
        
        /* ===== Logo Styles ===== */
        
        .corner-image {
            position: fixed;
            top: 20px;
            z-index: 100;
        }
        
        .left-corner {
            left: 20px;
        }
        
        .right-corner {
            right: 20px;
        }
        
        .corner-image img {
            width: 80px;
            height: 80px;
            border-radius: 200px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
        }
        
        .corner-image img:hover {
            transform: scale(1.05);
        }
        
        
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(10, 10, 10, 0.9) 0%, rgba(10, 10, 10, 0.6) 100%);
        }
        
        hr {
            border: none;
            height: 4px;
            background: linear-gradient(to right, red, blue);
        }
        
        .discountload {
            background: linear-gradient(135deg, #ff7eb3, #ff758c);
            /* Vibrant Pink-Red Gradient */
            height: 55px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0px 4px 15px rgba(255, 118, 118, 0.4);
            font-family: 'Poppins', sans-serif;
            font-size: 18px;
            font-weight: bold;
            color: #fff;
            position: relative;
            padding: 10px 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            border: 2px solid #ff5252;
            transition: transform 0.3s ease-in-out;
        }
        
        .discountload:hover {
            transform: scale(1.05);
            /* Slight zoom effect */
        }
        
        .discountload::before {
            content: "ðŸ”¥";
        
            left: 15px;
            font-size: 24px;
        }
        
        .discount-text {
            color: #ffd700;
            /* Golden color for the discount code */
        }
        .error-message {
            color: white;
            background-color: red;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }
            .container {
                width: 50%;
            }
        }
        @media (max-width: 768px) {
            .form-container {
                width: 25%; /* Reduce width */
                padding: 15px; /* Reduce padding */
            }
        }
        @media (max-width: 768px) {
            h1, h2 {
                font-size: 1.5rem; /* Reduce heading size */
            }
            button {
                font-size: 14px;
                padding: 8px 12px; /* Reduce button size */
            }
        }
        @media (max-width: 768px) {
            input, select {
                font-size: 14px;
                padding: 80px;
            }
        }
        @media (max-width: 480px) {
            .container {
                width: 95%;
                font-size: 12px;
            }
        }
/* Overlay Background */
.popup {
    display: none;
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background: rgba(25, 25, 25, 0.85); /* Darker Glassmorphism */
    backdrop-filter: blur(15px);
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0px 0px 15px rgba(0, 255, 255, 0.5);
    width: 360px;
    color: #fff;
    text-align: center;
    font-family: 'Poppins', sans-serif;
}

/* Header */
.popup h2 {
    font-size: 22px;
    margin-bottom: 15px;
    color: cyan;
    text-shadow: 0px 0px 5px cyan;
}

/* Close Button */
.close {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 20px;
    cursor: pointer;
    color: white;
}

/* Input Fields */
.popup input {
    width: 100%;
    padding: 12px;
    margin-top: 8px;
    border: none;
    outline: none;
    border-radius: 6px;
    background: rgba(50, 50, 50, 0.9);
    color: #fff;
    font-size: 16px;
    text-align: center;
    box-shadow: inset 0px 0px 5px cyan;
    transition: all 0.3s ease-in-out;
}

.popup input:focus {
    box-shadow: inset 0px 0px 10px cyan;
}

/* Recover Button */
#recover-btn {
    width: 100%;
    padding: 12px;
    margin-top: 15px;
    background: linear-gradient(45deg, cyan, #00f7ff);
    border: none;
    cursor: pointer;
    font-size: 18px;
    border-radius: 6px;
    font-weight: bold;
    color: #111;
    transition: all 0.3s ease-in-out;
}

#recover-btn:hover {
    background: linear-gradient(45deg, #00f7ff, cyan);
    box-shadow: 0px 0px 12px cyan;
}

/* Result Message */
#result-message {
    margin-top: 12px;
    font-size: 16px;
    color: lightgreen;
    font-weight: bold;
}

                
        
    </style>
</head>

<body>
    <div class="video-container">
        <video autoplay muted loop playsinline>
            <source src="https://res.cloudinary.com/dqbrxiewy/video/upload/v1740417439/WhatsApp_Video_2025-02-24_at_22.07.53_4a550d66_w8kjx0.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>
    <div class="corner-image left-corner Logo">
        <img src="https://res.cloudinary.com/dqbrxiewy/image/upload/v1740457247/clg_logo-removebg-preview_m6s0wz.png" alt="JNTUK Logo">
    </div>
    <div class="corner-image right-corner">
        <img src="https://res.cloudinary.com/dqbrxiewy/image/upload/v1740457231/festlogo-removebg-preview_wvnvwj.png" alt="Logo">
    </div>

    <form id="registrationForm" class="registration-form" method="POST" action="{% url 'register_workshop' %}">
         {% csrf_token %}
        <section class="d-flex flex-column justify-content-start">
            <div class="registration-card">
                <h2 class="section-title" style="text-decoration:underline">Workshop Registration</h2>


    {% if error %}
    <div class="error-message">
        <strong>Error:</strong> {{ error }}
    </div>
{% endif %}
                <input type="hidden" type="text" id="fee" name="fee" value="">
                 <input type="hidden" type="text" id="maxteamsize" name="maxteamsize" value="">
                 <input type="hidden" type="text" id="workshopname" name="workshopname" value="">

                <div class="form-group">
                    <label for="encursoId">Encurso Id:</label>
                    <input type="text" id="encursoId" name="encurso_id" placeholder="Enter your Encurso Id (Only 'UPPER' Case )" autocomplete="off" required  >
                    <select name="preference_1" class="preference-dropdown">
                        <option value="none" selected>No Preference</option>
                        <option value="accommodation">Accommodation Only (â‚¹250)</option>
                        <option value="food">Food Only (â‚¹400)</option>
                        <option value="both">Both Food & Accommodation (â‚¹600)</option>
                    </select>

                </div>

                <h4 style="color:#f7ff01"><a href="#" id="forgot-encurso-id">Forgot encurso_id?</a></h4>

                <div class="form-group">
                    <label for="workshop">Select Workshop:</label>
                    <select id="workshop" name="workshop" required>
                        <option value="" disabled selected>Choose a Workshop</option>
                    </select>
                </div>
                <div id="team-section" class="hidden">
                    <div id="team-members" class="form-group"></div>
                </div>
                <div class="discountload">
                    Get Offers on Registration! <span style="color: #ffd700;"> Until 3rd March</span>
                </div>
                <hr />
                <div style="display: flex; align-items: center; gap: 40px;margin-bottom:5px;">
                    <p id="total_fee" style="color:#ffffff">Total Fee: â‚¹0.00</p>
                </div>
                <button type="submit" class="btn cta-btn" style="background-color:#2ecc71;font-weight:800;color:#ffffff">
                    Complete Registration
                </button>
            </div>
        </section>
    </form>

<!-- Forgot ID Popup -->
<div id="forgot-popup" class="popup">
    <div class="popup-content">
        <span class="close">&times;</span>
        <h2>Recover Your Encurso ID</h2>
        <label for="forgot-email">Email:</label>
        <input type="email" id="forgot-email" required>
        <label for="forgot-phone">Phone Number:</label>
        <input type="text" id="forgot-phone" required>
        <button id="recover-btn">Recover</button>
        <p id="result-message"></p>
    </div>
</div>

</body>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const forgotLink = document.getElementById("forgot-encurso-id");
        const popup = document.getElementById("forgot-popup");
        const closeBtn = document.querySelector(".close");
        const recoverBtn = document.getElementById("recover-btn");
        const resultMessage = document.getElementById("result-message");
    
        // Show popup
        forgotLink.addEventListener("click", function (event) {
            event.preventDefault();
            popup.style.display = "block";
        });
    
        // Close popup
        closeBtn.addEventListener("click", function () {
            popup.style.display = "none";
            resultMessage.textContent = ""; // Clear message when closing
        });
    
        // Handle recovery
        recoverBtn.addEventListener("click", function () {
            const email = document.getElementById("forgot-email").value.trim();
            const phone = document.getElementById("forgot-phone").value.trim();
    
            if (!email || !phone) {
                resultMessage.textContent = "Please enter both email and phone.";
                return;
            }
    
            // API request
            fetch("/recover-encurso-id/", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email: email, phone: phone }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    resultMessage.textContent = `Your Encurso ID: ${data.encurso_id}`;
                } else {
                    resultMessage.textContent = "Invalid details. Please try again.";
                }
            })
            .catch(error => {
                resultMessage.textContent = "Something went wrong. Try again later.";
            });
        });
    });
    
    let discountApplied = false;

// Workshop data
let workshops = [
    { id: '1', name: 'HANDS-ON IOT', date: 'Mar 15,16', fee: 4000, requiresTeam: true, maxTeamSize: 3 },
    { id: '2', name: 'HANDS-ON IOT', date: 'Mar 15,16', fee: 6000, requiresTeam: true, maxTeamSize: 5 },
    { id: '3', name: 'HANDS-ON ELECTRIC VEHICLES', date: 'Mar 15,16', fee: 1400, requiresTeam: true, maxTeamSize: 1 },
    { id: '4', name: 'HANDS-ON ELECTRIC VEHICLES', date: 'Mar 15,16', fee: 3000, requiresTeam: true, maxTeamSize: 3 },
    { id: '5', name: 'HANDS-ON DRONE TECHNOLOGIES', date: 'Mar 15,16', fee: 1200, requiresTeam: true, maxTeamSize: 1 },
    { id: '6', name: 'HANDS-ON DRONE TECHNOLOGIES', date: 'Mar 15,16', fee: 3000, requiresTeam: true, maxTeamSize: 3 },
    { id: '7', name: 'MATLAB SIMULATION', date: 'Mar 15,16', fee: 900, requiresTeam: false, maxTeamSize: 1 }
];

// Discount Mapping
let discountMap = {
    '1': 3000, '2': 5000, '3': 1000, '4': 2400,
    '5': 1000, '6': 2400, '7': 500
};

// DOM Elements
let workshopSelect = document.getElementById('workshop');
let teamMembersContainer = document.getElementById("team-members");
let totalFeeElement = document.getElementById('total_fee');
let applyOfferButton = document.getElementById("apply_offer");
let teamSection = document.getElementById("team-section");
let maxteamsize = document.getElementById("maxteamsize");
let totfee = document.getElementById("fee");
let workshopname = document.getElementById("workshopname");

// Populate workshop dropdown
workshops.forEach(workshop => {
    let option = document.createElement('option');
    option.value = workshop.id;  // Set value as ID to match discountMap keys
    option.textContent = `${workshop.name} (${workshop.date}) - â‚¹${workshop.fee} (${workshop.maxTeamSize}-members)`;
    option.dataset.fee = workshop.fee;
    option.dataset.requiresTeam = workshop.requiresTeam;
    option.dataset.maxTeamSize = workshop.maxTeamSize;
    workshopname.value=workshop.name;
    workshopSelect.appendChild(option);
});

// Update Team Member Fields
function updateTeamMembers() {
    let selectedOption = workshopSelect.selectedOptions[0];
    let requiresTeam = selectedOption && selectedOption.dataset.requiresTeam === "true";
    let maxTeamSize = parseInt(selectedOption.dataset.maxTeamSize) || 1;

    teamMembersContainer.innerHTML = ""; // Clear previous inputs
    teamSection.style.display = requiresTeam ? "block" : "none";
    maxteamsize.value = maxTeamSize; // Update max team size

    if (requiresTeam) {
        for (let i = 2; i <= maxTeamSize; i++) {
            let memberDiv = document.createElement("div");
            memberDiv.classList.add("form-group");

            let idLabel = document.createElement("label");
            idLabel.textContent = `Member ${i} Encurso ID:`;

            let idInput = document.createElement("input");
            idInput.type = "text";
            idInput.name = `team_member_${i}_id`;
            idInput.placeholder = `Enter Member ${i} Encurso ID (Only 'UPPER' Case)`;
            idInput.required = true;

            // Accommodation & Food Options
            let selectDropdown = document.createElement("select");
            selectDropdown.name = `preference_${i}`;
            selectDropdown.classList.add("preference-dropdown");
            selectDropdown.innerHTML = `
                <option value="none" selected>No Preference</option>
                <option value="accommodation">Accommodation Only (â‚¹250)</option>
                <option value="food">Food Only (â‚¹400)</option>
                <option value="both">Both Food & Accommodation (â‚¹600)</option>
            `;

            selectDropdown.addEventListener("change", updateTotal);

            memberDiv.appendChild(idLabel);
            memberDiv.appendChild(idInput);
            memberDiv.appendChild(selectDropdown);
            teamMembersContainer.appendChild(memberDiv);
        }
    }
}

// Calculate Total Fee
function updateTotal() {
    let selectedOption = workshopSelect.selectedOptions[0];
    let workshopId = selectedOption ? selectedOption.value : null;
    let originalFee = selectedOption ? parseFloat(selectedOption.dataset.fee) || 0 : 0;

    // Apply discount based on workshop ID
    let discountedFee = discountMap[workshopId] ? discountMap[workshopId] : originalFee;

    let totalAccommodationFee = 0;
    let totalFoodFee = 0;

    document.querySelectorAll(".preference-dropdown").forEach(dropdown => {
        let value = dropdown.value;
        if (value === "accommodation") totalAccommodationFee += 250;
        if (value === "food") totalFoodFee += 400;
        if (value === "both") totalFoodFee += 600;
    });

    let totalOriginalFee = originalFee + totalAccommodationFee + totalFoodFee;
    let totalDiscountedFee = discountedFee + totalAccommodationFee + totalFoodFee;

    // Update displayed fee
    totalFeeElement.innerHTML = `Total Fee: <s>â‚¹${totalOriginalFee.toFixed(2)}</s> â‚¹${totalDiscountedFee.toFixed(2)}`;

    // Set fee input value for backend
    totfee.value = totalDiscountedFee;
}

// Event Listeners
document.addEventListener("DOMContentLoaded", function () {
    workshopSelect.addEventListener('change', () => {
        updateTeamMembers();
        updateTotal();
        
        // Update workshop name input value
        let selectedOption = workshopSelect.selectedOptions[0];
        if (selectedOption) {
            workshopname.value = selectedOption.textContent.split('(')[0].trim();
        }
    });
    document.querySelector(".preference-dropdown").addEventListener("change", updateTotal);
});

</script>
</html>